(this["webpackJsonptic-tac-toe-client"]=this["webpackJsonptic-tac-toe-client"]||[]).push([[0],{107:function(e,t){},109:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(50),c=n.n(r),i=(n(62),n(20)),o=n(2),l=n(7),u=n(0),j=function(e){var t=e.type,n=e.label,a=e.onClick;return Object(u.jsx)("button",{className:"btn btn-".concat(t),onClick:a,children:n})},d=function(e){var t=e.onChoice;return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"choice-container",children:[Object(u.jsx)(j,{onClick:function(){return t("new")},type:"primary",label:"Start New Game"}),Object(u.jsx)(j,{onClick:function(){return t("join")},type:"secondary",label:"Join A Game"})]})})},h=function(e){var t=e.loading;return Object(u.jsxs)("div",{className:"loader",style:{display:t?"flex":"none"},children:[Object(u.jsx)("i",{className:"fa fa-spinner fa-pulse fa-4x fa-fw"}),Object(u.jsx)("span",{style:{userSelect:"none"},children:"Loading..."})]})},b=function(e){var t=e.display,n=e.message;return Object(u.jsx)("div",{className:"error",style:{opacity:t?"100%":"0"},children:Object(u.jsx)("h1",{className:"error-message",children:n})})},m=function(e){var t=e.stepBack,n=e.onSubmit,a=e.onTyping,s=e.newGame,r=e.name,c=e.room;return s?Object(u.jsxs)("div",{className:"input-container",children:[Object(u.jsx)("input",{name:"name",placeholder:"Your Name...",onChange:a,value:r}),Object(u.jsxs)("div",{className:"nav-container",children:[Object(u.jsx)(j,{type:"nav-back",choice:"back",onClick:t,label:"Back"}),Object(u.jsx)(j,{type:"nav-forward",choice:"submit",onClick:n,label:"Let's Go"})]})]}):Object(u.jsxs)("div",{className:"input-container",children:[Object(u.jsx)("input",{name:"name",placeholder:"Your Name...",onChange:a,value:r}),Object(u.jsx)("input",{name:"room",placeholder:"Room ID...",onChange:a,value:c}),Object(u.jsxs)("div",{className:"nav-container",children:[Object(u.jsx)(j,{type:"nav-back",choice:"back",onClick:t,label:"Back"}),Object(u.jsx)(j,{type:"nav-forward",choice:"submit",onClick:n,label:"Let's Go"})]})]})},p=n(21),f=n.n(p),O=null,v=function(){return O||(O=f()("ws://localhost:4000"))},y=function(){var e=s.a.useState(1),t=Object(l.a)(e,2),n=t[0],a=t[1],r=s.a.useState(""),c=Object(l.a)(r,2),i=c[0],j=c[1],p=s.a.useState(null),f=Object(l.a)(p,2),y=f[0],x=f[1],g=s.a.useState(""),k=Object(l.a)(g,2),S=k[0],w=k[1],N=s.a.useState(!1),C=Object(l.a)(N,2),P=C[0],M=C[1],B=s.a.useState(!1),R=Object(l.a)(B,2),D=R[0],G=R[1],T=s.a.useState(!1),A=Object(l.a)(T,2),q=A[0],E=A[1],I=s.a.useState(""),J=Object(l.a)(I,2),F=J[0],W=J[1],Y=function(){a(n-1)},L=function(e){x("new"===e),a(n+1)},X=function(e){var t=e.target.name,n=e.target.value;"name"===t?j(n):"room"===t&&w(n)},H=function(e){E(!0),W(e),M(!1),setTimeout((function(){E(!1),W("")}),3e3)},U=function(){M(!0),(y?""!==i:""!==i&&""!==S)?y?(O.emit("newGame"),console.log("Je demande \xe0 appeler le serveur pour cr\xe9er une nouvelle partie !")):(console.log("Je demande \xe0 appeler le serveur pour rejoindre une nouvelle partie !"),function(e){O.emit("joining",{room:e})}(S)):H(y?"Please fill out your name":"Please fill out your name and room id")};s.a.useEffect((function(){var e=v();return e.on("newGameCreated",(function(e){w(e),G(!0)})),e.on("joinConfirmed",(function(){G(!0)})),e.on("errorMessage",(function(e){return H(e)})),function(){e=null}}),[]);return function(){if(D)return Object(u.jsx)(o.a,{to:"/game?room=".concat(S,"&name=").concat(i)});switch(n){case 1:return Object(u.jsx)(d,{onChoice:L});case 2:return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(h,{loading:P}),Object(u.jsx)(b,{display:q,message:F}),Object(u.jsx)(m,{stepBack:Y,onSubmit:U,onTyping:X,newGame:y,name:i,room:S})]});default:return null}}()},x=n(52),g=n(53),k=n(56),S=n(55),w=n(57),N={background:"white",width:"93%",height:"13%",position:"absolute",transform:"rotate(45deg)"},C={background:"white",width:"93%",height:"13%",position:"absolute",transform:"rotate(-45deg)"},P=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"before",style:N}),Object(u.jsx)("div",{className:"after",style:C})]})},M={background:"white",width:"90%",height:"90%",position:"absolute",borderRadius:"50%"},B={background:"var(--dark-blue)",width:"70%",height:"70%",position:"absolute",borderRadius:"50%"},R=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"before",style:M}),Object(u.jsx)("div",{className:"after",style:B})]})},D=function(e){switch(e.value){case"X":return Object(u.jsx)(P,{});case"O":return Object(u.jsx)(R,{});default:if(e.end||!e.turn)return Object(u.jsx)("div",{});switch(e.player){case"X":return Object(u.jsx)("div",{className:"placeHolder",children:Object(u.jsx)(P,{})});case"O":return Object(u.jsx)("div",{className:"placeHolder",children:Object(u.jsx)(R,{})});default:return Object(u.jsx)("div",{})}}},G=function(e){return Object(u.jsx)("div",{className:"square",onClick:e.onClick.bind(undefined,e.id),children:Object(u.jsx)(D,Object(w.a)({},e))})},T=function(e){var t=e.room,n=e.display,s=Object(a.useRef)(null);return Object(u.jsxs)("div",{className:"wait",style:{display:n?"flex":"none"},children:[Object(u.jsx)("h1",{className:"wait-message",children:"Waiting for player to connect..."}),Object(u.jsxs)("div",{className:"copy",children:[Object(u.jsx)("h1",{className:"copy-message",children:"Give your friend the following room id to connect"}),Object(u.jsxs)("div",{className:"copy-container",children:[Object(u.jsx)("input",{ref:s,readOnly:!0,value:t,className:"copy-area"}),Object(u.jsx)("button",{className:"copy-button",onClick:function(){s.current.select(),document.execCommand("copy")},children:"Copy"})]})]})]})};function A(e){var t=e.message;return Object(u.jsx)("div",{className:"status",children:Object(u.jsx)("h1",{className:"status-message",children:t})})}function q(e){var t=e.end,n=e.onClick;return Object(u.jsx)("div",{className:"again-container",children:Object(u.jsx)("button",{className:"again-button",onClick:n,style:{visibility:t?"visible":"hidden",opacity:t?"1":"0"},children:"Play Again"})})}function E(e){var t=e.name,n=e.score;return Object(u.jsxs)("div",{className:"score-container",children:[Object(u.jsx)("h1",{className:"name",children:t}),Object(u.jsx)("h1",{className:"score",children:n})]})}function I(e){var t=e.data;return Object(u.jsxs)("div",{className:"score-board",children:[Object(u.jsx)("h1",{className:"score-title",children:"Score Board"}),Object(u.jsx)(E,{name:t.player1[0],score:t.player1[1]}),Object(u.jsx)(E,{name:t.player2[0],score:t.player2[1]})]})}var J=n(54),F=n.n(J),W=function(e){Object(k.a)(n,e);var t=Object(S.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).handleClick=function(e){var t=a.state,n=t.game,s=t.piece,r=t.end,c=t.turn,i=t.room;n[e]||r||!c||a.socket.emit("move",{room:i,piece:s,index:e})},a.playAgainRequest=function(){a.socket.emit("playAgainRequest",a.state.room)},a.state={game:new Array(9).fill(null),piece:"X",turn:!0,end:!1,room:"",statusMessage:"",currentPlayerScore:0,opponentPlayer:[],waiting:!1,joinError:!1},a.socketID=null,a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.socket=f()("ws://localhost:4000");var t=F.a.parse(window.location.search,{ignoreQueryPrefix:!0}),n=t.room,a=t.name;this.setState({room:n}),this.socket.emit("newRoomJoin",{room:n,name:a}),this.socket.on("waiting",(function(){return e.setState({waiting:!0,currentPlayerScore:0,opponentPlayer:[]})})),this.socket.on("starting",(function(t){var n=t.gameState,a=t.players,s=t.turn;e.setState({waiting:!1}),e.gameStart(n,a,s)})),this.socket.on("joinError",(function(){return e.setState({joinError:!0})})),this.socket.on("pieceAssignment",(function(t){var n=t.piece,a=t.id;e.setState({piece:n}),e.socketID=a})),this.socket.on("update",(function(t){var n=t.gameState,a=t.turn;return e.handleUpdate(n,a)})),this.socket.on("winner",(function(t){var n=t.gameState,a=t.id;return e.handleWin(a,n)})),this.socket.on("draw",(function(t){var n=t.gameState;return e.handleDraw(n)})),this.socket.on("restart",(function(t){var n=t.gameState,a=t.turn;return e.handleRestart(n,a)}))}},{key:"gameStart",value:function(e,t,n){var a=this,s=t.filter((function(e){var t=Object(l.a)(e,2),n=t[0];t[1];return n!==a.socketID}))[0][1];this.setState({opponentPlayer:[s,0],end:!1}),this.setBoard(e),this.setTurn(n),this.setMessage()}},{key:"handleUpdate",value:function(e,t){this.setBoard(e),this.setTurn(t),this.setMessage()}},{key:"handleWin",value:function(e,t){if(this.setBoard(t),this.socketID===e){var n=this.state.currentPlayerScore+1;this.setState({currentPlayerScore:n,statusMessage:"You Win"})}else{var a=this.state.opponentPlayer[1]+1,s=this.state.opponentPlayer;s[1]=a,this.setState({opponentPlayer:s,statusMessage:"".concat(this.state.opponentPlayer[0]," Wins")})}this.setState({end:!0})}},{key:"handleDraw",value:function(e){this.setBoard(e),this.setState({end:!0,statusMessage:"Draw"})}},{key:"handleRestart",value:function(e,t){this.setBoard(e),this.setTurn(t),this.setMessage(),this.setState({end:!1})}},{key:"setMessage",value:function(){var e=this.state.turn?"Your Turn":"".concat(this.state.opponentPlayer[0],"'s Turn");this.setState({statusMessage:e})}},{key:"setTurn",value:function(e){this.state.piece===e?this.setState({turn:!0}):this.setState({turn:!1})}},{key:"setBoard",value:function(e){this.setState({game:e})}},{key:"renderSquare",value:function(e){return Object(u.jsx)(G,{value:this.state.game[e],player:this.state.piece,end:this.state.end,id:e,onClick:this.handleClick,turn:this.state.turn},e)}},{key:"render",value:function(){if(this.state.joinError)return Object(u.jsx)(o.a,{to:"/"});for(var e=[],t=0;t<9;t++){var n=this.renderSquare(t);e.push(n)}return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(T,{display:this.state.waiting,room:this.state.room}),Object(u.jsx)(A,{message:this.state.statusMessage}),Object(u.jsx)("div",{className:"board",children:e}),Object(u.jsx)(I,{data:{player1:["You",this.state.currentPlayerScore],player2:[this.state.opponentPlayer[0],this.state.opponentPlayer[1]]}}),Object(u.jsx)(q,{end:this.state.end,onClick:this.playAgainRequest})]})}}]),n}(a.Component),Y=function(){return Object(u.jsxs)(i.a,{children:[Object(u.jsx)(o.b,{path:"/",exact:!0,component:y}),Object(u.jsx)(o.b,{path:"/game",component:W})]})};c.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(Y,{})}),document.getElementById("root"))},62:function(e,t,n){}},[[109,1,2]]]);
//# sourceMappingURL=main.155618f8.chunk.js.map